<!DOCTYPE html>
<html>
<head>
    <title>Hello Cocos2d-JS</title> 
    <script type="text/javascript" src="cocos2d-html5-v3.0-beta-min.js"></script>
</head>
<body>	 
    <canvas id="gameCanvas" width="800" height="450"></canvas>
    <!--<script src="./plugin/Plugin.js"></script>-->
    <!--<script src="./plugin/platform/facebook.js"></script>-->
    <!--<script src="./plugin/platform/facebook_sdk.js"></script>-->
    <script type="text/javascript">
        var ITEM_TAG_BASIC = 1000;
        window.onload = function(){
            cc.game.onStart = function(){

                var s_EventMenuItem = [
                    {
                        itemTitle: "login",
                        test: function(){
                            /*
                            Plugin.login(function(status){
                                console.log("login callback, status: " + status);
                            });
                            */
//                            var pluginManager = plugin.PluginManager.getInstance();
//                            var ufb = pluginManager.loadPlugin("UserFacebook");
                            plugin.agentManager.login(function(type, msg){
                                console.log("login callback, status: %s", type);
                                console.log("login callback, msg: %s", msg)
                            });
                        }
                    },{
                        itemTitle: "logout",
                        test: function(){
                            var pluginManager = plugin.PluginManager.getInstance();
                            var ufb = pluginManager.loadPlugin("UserFacebook");
                            ufb.logout(function(type, msg){
                                console.log("logout callback, status: %s", type);
                                console.log("logout callback, msg: %s", msg)
                            });
                        }
                    },{
                        itemTitle: "getUid",
                        test: function(){
                            var uid = plugin.agentManager.getUserId();
                            cc.log(uid);
                        }
                    },{
                        itemTitle: "getToken",
                        test: function(){
                            var token = plugin.agentManager.getToken();
                            cc.log(token);
                        }
                    },{
                        itemTitle: "isLogin",
                        test: function(){
                            var o = plugin.agentManager.isLogined(function(status){
                                if(status === 0){
                                    console.log("callback - login");
                                }else{
                                    console.log("callback - no login");
                                }
                            });
                            console.log("sync - login: " + o);
                        }
                    },{
                        itemTitle: "onShareLink",
                        test: function(){
                            Plugin.share({
                                link: "http://code.itharbors.com"
                            }, function(status){
                                if(status === 0){
                                    console.log("callback - share");
                                }else{
                                    console.log("callback - no share");
                                }
                            });
                        }
                    },{
                        itemTitle: "onShareOG",
                        test: function(){

                        }
                    },{
                        itemTitle: "onSharePhoto",
                        test: function(){

                        }
                    },{
                        itemTitle: "onLinkMsg",
                        test: function(){

                        }
                    },{
                        itemTitle: "onOGMsg",
                        test: function(){

                        }
                    },{
                        itemTitle: "onPhotoMsg",
                        test: function(){

                        }
                    }
                ];


                //load resources
                cc.LoaderScene.preload(["HelloWorld.png"], function () {
                    var MyScene = cc.Scene.extend({
                        onEnter:function () {
                            this._super();
                            var size = cc.director.getWinSize();
                            var sprite = cc.Sprite.create("HelloWorld.png");
                            sprite.setPosition(size.width / 2, size.height / 2);
                            sprite.setScale(0.8);
                            this.addChild(sprite, 0);

                            var winSize = cc.director.getWinSize();

                            var pMenu = cc.Menu.create();
                            pMenu.x = 0;
                            pMenu.y = 0;
                            cc.MenuItemFont.setFontName("Arial");
                            cc.MenuItemFont.setFontSize(24);
                            for (var i = 0; i < s_EventMenuItem.length; ++i) {
                                var selItem = s_EventMenuItem[i];
                                var pItem = cc.MenuItemFont.create(selItem.itemTitle, this.menuCallback, this);
                                if(i<5){
                                    pItem.x = winSize.width / 4;
                                    pItem.y = winSize.height - 100 -  (i + 1) * 40;
                                }else{
                                    pItem.x = winSize.width / 4 *3;
                                    pItem.y = winSize.height - 100 -  (i + -5) * 40;
                                }
                                pMenu.addChild(pItem, ITEM_TAG_BASIC + i);
                            }
                            this.addChild(pMenu);

                        },
                        menuCallback: function(sender){
                            var nIndex = sender.zIndex - ITEM_TAG_BASIC;
                            s_EventMenuItem[nIndex].test();
                        }
                  });
                  cc.director.runScene(new MyScene());
                }, this);

            };
            cc.game.run("gameCanvas");
        };
    </script>
</body>
</html>