!function(){var a={chrome:"chrome",firefox:"firefox",ie:"ie",opera:"opera",safari:"safari",micromessage:"微信",qqbrowser:"QQ",baidu:"百度",uc:"UC",liebao:"猎豹"},b={IOS:"ios",ANDROID:"android",WINDOWS:"windows",MAC:"mac",LINUX:"linux",UNIX:"unix"},c=0,d={};d.inherit=function(a,b){a.super_=b,a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})},d.pathJoin=function(a,b){var c=a+b;return c=c.replace(/([^\/]+\/[^\/]+\/[^\/]+)\.\.\/\.\.\//g,""),c=c.replace(/([^\/]+\/[^\/]+)\.\.\//g,""),c=c.replace(/[^\/]+\.\//g,"")};{var e=function(){var c={id:"gameCanvas",fps:60,getter:null,debug:!1,system:{}},d=c.system,e=navigator.userAgent.toLowerCase(),f=navigator.appVersion.toLowerCase(),g=navigator.platform.toLowerCase(),i="";e.indexOf("msie")>-1||e.indexOf("trident")>-1?(d.browser=a.ie,i=e.match(/msie ([\d.]+)/),i?d.version=i[1]:(i=e.match(/rv:([\d.]+)/),d.version=i?i[1]:"")):e.indexOf("firefox")>-1?(d.browser=a.firefox,i=e.match(/firefox\/([\d.]+)/),i?d.version=i[1]:(i=e.match(/rv:([\d.]+)/),d.version=i?i[1]:"")):e.indexOf("micromessenger")>-1?(d.browser=a.micromessage,i=e.match(/micromessenger\/([\d.]+)/),d.version=i?i[1]:""):e.indexOf("mqqbrowser")>-1?(d.browser=a.qqbrowser,i=e.match(/mqqbrowser\/([\d.]+)/),d.version=i?i[1]:""):e.indexOf("baidubrowser")>-1?(d.browser=a.baidu,i=e.match(/baidubrowser\/([\d.]+)/),d.version=i?i[1]:""):e.indexOf("ucbrowser")>-1?(d.browser=a.uc,i=e.match(/ucbrowser\/([\d.]+)/),d.version=i?i[1]:""):e.indexOf("liebaofast")>-1?(d.browser=a.liebao,i=e.match(/liebaofast\/([\d.]+)/),d.version=i?i[1]:""):e.indexOf("chrome")>-1?(d.browser=a.chrome,i=e.match(/chrome\/([\d.]+)/),d.version=i?i[1]:""):e.indexOf("oupeng")>-1?(d.browser=a.opera,i=e.match(/oupeng\/([\d.]+)/),d.version=i?i[1]:""):e.indexOf("safari")>-1&&(d.browser=a.safari,i=e.match(/safari\/([\d.]+)/),d.version=i?i[1]:""),d.version=d.version||"",d.browser=d.browser||"",d.language=(navigator.browserLanguage||navigator.language).toLowerCase(),d.isMobile=e.indexOf("mobile")>-1||e.indexOf("android")>-1,e.match(/(ipad|iphone|ipod)/)?d.os=b.IOS:e.indexOf("android")>-1||g.indexOf("android")>-1?d.os=b.ANDROID:f.indexOf("win")>-1?d.os=b.WINDOWS:f.indexOf("mac")>-1?d.os=b.MAC:f.indexOf("x11")>-1?d.os=b.UNIX:f.indexOf("linux")&&(d.os=b.LINUX),d.visibleSize={};var j=document.getElementById(c.id);d.canvasSize={},d.scale={},d.margin={},c.setCanvas=function(a){j=a},c.initOption=function(a,b){d.canvasSize.width=j.width,d.canvasSize.height=j.height,d.margin.left=c.getter.marginLeft(j),d.margin.top=c.getter.marginTop(j),d.visibleSize.width=c.getter.visibleWidth(),d.visibleSize.height=c.getter.visibleHeight(),c.adaptive?(d.scale.x=a,d.scale.y=b):(d.scale.x=1,d.scale.y=1)};var k=null;return window.addEventListener("resize",function(){c.initOption(),c.adaptive&&(clearTimeout(k),k=setTimeout(h.adaptive,200))}),c}(),f=function(){var a=function(){};return a.prototype.accessEvent={touchDown:{bind:function(a){this.touchDownEventList||(this.touchDownEventList=[]),r.addTouchDown(this),this.touchDownEventList.push(a)},unbind:function(a){var b=this.touchDownEventList;if(b){for(var c=0;c<b.length;c++)if(b[c]===a){b.splice(c,1);break}0===b.length&&r.removeTouchDown(this)}}},touchMove:{bind:function(a){this.touchMoveEventList||(this.touchMoveEventList=[]),r.addTouchMove(this),this.touchMoveEventList.push(a)},unbind:function(a){var b=this.touchMoveEventList;if(b){for(var c=0;c<b.length;c++)if(b[c]===a){b.splice(c,1);break}0===b.length&&r.removeTouchMove(this)}}},touchUp:{bind:function(a){this.touchUpEventList||(this.touchUpEventList=[]),r.addTouchUp(this),this.touchUpEventList.push(a)},unbind:function(a){var b=this.touchUpEventList;if(b){for(var c=0;c<b.length;c++)if(b[c]===a){b.splice(c,1);break}0===b.length&&r.removeTouchUp(this)}}},load:{bind:function(a){this.loadEventList||(this.loadEventList=[]),this.loadEventList.push(a)},unbind:function(a){var b=this.loadEventList;if(b)for(var c=0;c<b.length;c++)if(b[c]===a){b.splice(c,1);break}}}},a.prototype.on=function(a,b){return this.accessEvent[a]?this.accessEvent[a].bind.call(this,b):h.log("传入事件名错误"),this},a.prototype.off=function(a,b){return this.accessEvent[a]?this.accessEvent[a].unbind.call(this,b):h.log("传入事件名错误"),this},a.prototype.touchDown=function(a,b){if(a)return this.accessEvent.touchDown.bind.call(this,a),this;var c=this.touchDownEventList;if(c){var d,e;for(d=0,e=c.length;e>d;d++)c[d](b)}return this},a.prototype.touchDownEventList=null,a.prototype.touchMove=function(a,b){if(a)return this.accessEvent.touchMove.bind.call(this,a),this;var c=this.touchMoveEventList;if(c){var d,e;for(d=0,e=c.length;e>d;d++)c[d](b)}return this},a.prototype.touchMoveEventList=null,a.prototype.touchUp=function(a,b){if(a)return this.accessEvent.touchUp.bind.call(this,a),this;var c=this.touchUpEventList;if(c){var d,e;for(d=0,e=c.length;e>d;d++)c[d](b)}return this},a.prototype.touchUpEventList=null,a.prototype.load=function(a){if(a)return this.accessEvent.load.bind.call(this,a),this;var b=this.loadEventList;if(b){var c,d;for(c=0,d=b.length;d>c;c++)b[c]()}return this},a.prototype.loadEventList=null,a}(),g=function(){var a=function(a){this.node=a,this.storage={}};return a.prototype={constructor:a,get coordinateX(){for(var a=this.left,b=this.node.parent;b;)a+=b.style.x,b=b.parent;return a},get coordinateY(){for(var a=this.top,b=this.node.parent;b;)a+=b.style.y,b=b.parent;return a},get left(){var a=this.storage;if(a.innerTextArray){if("center"===a.align)return(a.left||0)-a.innerTextWidth/2;if("right"===a.align)return a.left-a.innerTextWidth}return a.left||0},set left(a){this.storage.left=a},get right(){return h.canvas.cache.width-this.storage.left-this.width},set right(a){this.storage.top=h.canvas.cache.width-this.width-a},get top(){return this.storage.top||0},set top(a){this.storage.top=a},get bottom(){return h.canvas.cache.height-this.storage.top-this.height},set bottom(a){this.storage.top=h.canvas.cache.height-this.height-a},get x(){return this.storage.left||0},set x(a){return this.storage.left=a},get y(){return this.storage.top||0},set y(a){this.storage.top=a},get rotate(){return this.storage.rotate||0},set rotate(a){this.storage.rotate=parseFloat(a)},get scale(){var a=this.storage;return a.scaleX===a.scaleY?a.scaleX||1:a.scaleX||"1 "+a.scaleY||1},set scale(a){var b=this.storage,c=a.toString().split(" ");1===c.length?b.scaleX=b.scaleY=c[0]:(b.scaleX=c[0],b.scaleY=c[1])},get scaleX(){return this.storage.scaleX||1},set scaleX(a){this.storage.scaleX=parseFloat(a)},get scaleY(){return this.storage.scaleY||1},set scaleY(a){this.storage.scaleY=parseFloat(a)},get anchorX(){return void 0===this.storage.anchorX?.5:this.storage.anchorX},set anchorX(a){this.storage.anchorX=parseFloat(a)},get anchorY(){return void 0===this.storage.anchorY?.5:this.storage.anchorY},set anchorY(a){this.storage.anchorY=parseFloat(a)},get width(){var a=this.storage;return a.width?a.width:a.image?a.image.width:a.innerTextWidth?a.innerTextWidth:0},set width(a){var b=this.node;this.storage.width=a,b.cache&&(b.cache.width=a,b.waitDrawing=!0,b.update())},get height(){var a=this.storage;return a.height?a.height:a.image?a.image.height:a.innerTextArray?this.lineHeight*(a.innerTextRow||a.innerTextArray.length)+4:0},set height(a){var b=this.node;this.storage.height=a,b.cache&&(b.cache.height=a,b.waitDrawing=!0,b.update())},get color(){return this.storage.color||"#000"},set color(a){this.storage.color=a},get opacity(){return this.storage.opacity||1},set opacity(a){this.storage.opacity=parseFloat(a)},get zIndex(){return this.storage.zIndex||0},set zIndex(a){this.storage.zIndex=parseInt(a)},get background(){return this.storage.background||"#FFF"},set background(a){this.storage.background=a},get image(){return this.storage.image},set image(a){"string"==typeof a&&(a=k.manager.create(a)),a.nodeList.push(this.node),this.storage.image=a},get imageSize(){return this.imageSizeWidth+"px "+this.imageSizeHeight+"px"},set imageSize(a){var b=a.split(" ");1===b.length?this.imageSizeWidth=this.imageSizeHeight=b[0]:2===b.length&&(this.imageSizeWidth=b[0],this.imageSizeHeight=b[1])},get imageSizeWidth(){return this.storage.imageSizeWidth||this.width},set imageSizeWidth(a){this.storage.imageSizeWidth=parseInt(a)},get imageSizeHeight(){return this.storage.imageSizeHeight||this.height},set imageSizeHeight(a){this.storage.imageSizeHeight=parseInt(a)},get imagePosition(){return this.imagePositionLeft+"px "+this.imagePositionTop+"px"},set backgroundPosition(a){var b=a.split(" ");1===b.length?this.imagePositionLeft=this.imagePositionTop=b[0]:2===b.length&&(this.imagePositionLeft=parseInt(b[0]),this.imagePositionTop=parseInt(b[1]))},get imagePositionLeft(){return this.storage.imagePositionLeft||0},set imagePositionLeft(a){this.storage.imagePositionLeft=parseInt(a)},get imagePositionTop(){return this.storage.imagePositionTop||0},set imagePositionTop(a){this.storage.imagePositionTop=parseInt(a)},get align(){return this.storage.align||"left"},set align(a){this.storage.align=a},get lineHeight(){return this.storage.lineHeight||this.fontSize},set lineHeight(a){this.storage.lineHeight=parseInt(a)},get font(){return this.fontStyle+" "+this.fontSize+"px "+this.fontFamily},set font(a){var b=a.split(" ");switch(b.length){case 1:this.fontSize=b[0];break;case 2:this.fontStyle=b[0],this.fontSize=b[1];break;case 3:this.fontStyle=b[0],this.fontSize=b[1],this.fontFamily=b[2]}},get fontStyle(){return this.storage.fontStyle||"Normal"},set fontStyle(a){this.storage.fontStyle=a},get fontSize(){return this.storage.fontSize||14},set fontSize(a){this.storage.fontSize=parseInt(a)},get fontFamily(){return this.storage.fontFamily||"Arial"},set fontFamily(a){this.storage.fontFamily=a.toString()}},a}(),i=function(){var a,b,c,d,f=0,g={get line(){return f},getDrawTime:function(){}},h=null;return g.init=function(){b=0,a=1e3/e.fps},g.init(),g.start=function(e){c=new Date;var i=function(){d=new Date,b=d-c,f+=b;var j=b/a;e(j),c=d;var k=new Date,l=k-d;g.getDrawTime(l),h=l>a?setTimeout(function(){i()},0):setTimeout(function(){i()},a-l)};i()},g}(),j=function(){var a=function(a){this.node=a,this.storage={}};return d.inherit(a,g),a}(),k=function(){var a=function(a){a&&this.setImage(a),this.nodeList=[];var b=this;this.on("load",function(){b.width=b.image.width,b.height=b.image.height,b.loaded=!0;var a,c;for(a=0,c=b.nodeList.length;c>a;a++)b.nodeList[a].update()})};return d.inherit(a,f),a.prototype.loaded=!1,a.prototype.path="",a.prototype.image=null,a.prototype.width=0,a.prototype.height=0,a.prototype.setImage=function(a){this.path=a,this.image=document.createElement("img");var b=this;return this.image.addEventListener("load",function(){b.load()}),this.image.src=a,this},a.manager={pathToElem:{},create:function(b){if(a.manager.pathToElem[b])return a.manager.pathToElem[b];var c=new a(b);return a.manager.pathToElem[b]=c,c}},a}(),l=function(){var a=function(){this.uniqueNumber=c++,this.parent=null,this.style=new g(this),this.active=!1,this.animate=!1};d.inherit(a,f);var b=function(a){for(var b in a)e.call(this,b,a[b])},e=function(a,b){this.style[a]=b};return a.prototype.update=function(){for(var a=this.parent;a&&!a.waitDrawing;)a.waitDrawing=!0,a=a.parent},a.prototype.get=function(a){return this.style[a]},a.prototype.set=function(a,c){switch(arguments.length){case 2:e.call(this,a,c);break;case 1:b.call(this,a)}return this.update(),this},a.prototype.frame=function(a,b){b=b||Number.MAX_VALUE;var c=0,d=a.length,e=this;e.animate=!0;var f=function(){var g=a[c++];for(var i in g)"time"!==i&&(e.style[i]=g[i]);e.active&&g.time&&e.animate&&b>0?h.delay(f,g.time):e.animate=!1,c>=d&&(c=0,b--),e.update()},g=a[c++];for(var i in g)"time"!==i&&(e.style[i]=g[i]);h.delay(f,g.time),this.update()},a.prototype.stop=function(){this.animate=!1},a.prototype.to=function(a,b,c,d){var e,f,g=this.style,j={};for(f in a)e=a[f]-g[f],isNaN(e)?console.log("动画不支持设置 "+f+" 属性"):(a[f]=e,j[f]=g[f]);var k=this;k.animate=!0;var l=i.line,m=function(){if(k.active&&k.animate){var e=i.line-l,g=e/b;d&&(g=d(g),0>g&&(g=-g)),g>=1?(g=1,"function"==typeof c&&c()):h.delay(m,1);for(f in a)k.style[f]=j[f]+a[f]*g;k.update()}};return h.delay(m,1),this},a}(),m=function(){var a=0,b=function(b){this.audioID=a++,b&&this.setPath(b)};return b.prototype.setPath=function(a){this.audio=document.createElement("audio"),this.path=a,this.audio.src=a},b.prototype.play=function(){this.stop(),this.audio.play()},b.prototype.stop=function(){this.audio.load()},b}(),n=function(){var a=function(){this.uniqueNumber=c++,this.parent=null,this.style=new j(this),this.active=!1,this.animate=!1};return d.inherit(a,l),a.prototype.text=function(a){return void 0!==a?(this.style.storage.innerTextArray=a.toString().split("\n"),delete this.style.storage.innerTextWidth,this.update(),this):this.style.storage.innerTextArray.join("\n")},a}(),o=function(){var a=function(){this.uniqueNumber=c++,this.parent=null,this.style=new g(this),this.active=!1,this.animate=!1,this.cache=document.createElement("canvas"),this.cache.width=this.style.width,this.cache.height=this.style.height,this.waitDrawing=!1,this.children=[]};d.inherit(a,l);var b=function(a,c){a.active=c;var d=a.children;if(d)for(var e=0;e<d.length;e++)b(d[e],c)};return a.prototype.append=function(a){b(a,!0),a.parent=this;var c,d,e=this.children;for(c=0,d=e.length;d>c;c++)if(this.children[c]===a)return;var f=a.style.zIndex;for(c=e.length;c>0&&!(e[c-1].style.zIndex<=f);c--);e.splice(c,0,a),this.waitDrawing=!0,this.update()},a.prototype.remove=function(a){a.parent=this;var c,d,e=this.children;for(c=0,d=e.length;d>c;c++)if(e[c]===a){b(a,!1),e.splice(c,1);break}this.waitDrawing=!0,this.update()},a}(),p=function(){var a=function(){};return a.prototype.full=function(a){a.style.width=e.system.visibleSize.width+"px",a.style.height=e.system.visibleSize.height+"px";var b=e.system.visibleSize.width/a.width,c=e.system.visibleSize.height/a.height;e.initOption(b,c)},a.prototype.width=function(a){var b=e.system.visibleSize.width/a.width;a.style.width=e.system.visibleSize.width+"px",a.style.height=a.height*b+"px",e.initOption(b,b)},a.prototype.height=function(a){var b=e.system.visibleSize.height/a.height;a.style.width=a.width*b+"px",a.style.height=e.system.visibleSize.height+"px",e.initOption(b,b)},a.prototype.min=function(a){var b=e.system.visibleSize.width/a.width,c=e.system.visibleSize.height/a.height;c>b?(a.style.width=e.system.visibleSize.width+"px",a.style.height=a.height*b+"px",e.initOption(b,b)):(a.style.width=a.width*c+"px",a.style.height=e.system.visibleSize.height+"px",e.initOption(c,c))},a.prototype.max=function(a){var b=e.system.visibleSize.width/a.width,c=e.system.visibleSize.height/a.height;b>c?(a.style.width=e.system.visibleSize.width+"px",a.style.height=a.height*b+"px",e.initOption(b,b)):(a.style.width=a.width*c+"px",a.style.height=e.system.visibleSize.height+"px",e.initOption(c,c))},new a}(),q=function(){var a={},b=Math.PI/180,c=function(b,c,d,e){a.drawer.drawRect(d.storage.background,b,c,d.width,d.height,e)},d=function(b,c,d,e){var f=d.width,g=d.height,h=d.storage.image.canvas||d.storage.image.image;(0!=f||0!=g)&&a.drawer.drawImage(h,d.imagePositionLeft,d.imagePositionTop,f,g,b,c,d.imageSizeWidth,d.imageSizeHeight,e)},e=function(b,c,d,e,f){var g,h,i=e.storage,j=b.length,k=e.width,l=e.fontSize,m=i.align,n=e.lineHeight,o=(n-l)/2;for(i.width?("right"===m&&(c+=k),"center"===m&&(c+=k/2)):("right"===m&&(c+=i.innerTextWidth),"center"===m&&(c+=i.innerTextWidth/2)),g=0;j>g;g++)h=b[g],a.drawer.drawFont(h,l,e.color,c,d+g*n+o,f)},f=function(b,c){a.drawer.setFont(b.fontStyle,b.fontSize,b.fontFamily,b.align,c)},g=function(a,g){if(a){var h,i,j=a.storage,k=j.innerTextArray;if(g.globalAlpha!==a.opacity&&(g.globalAlpha=a.opacity),j.innerTextArray){h=[],i=k.length,f(a,g);var l;if(j.width){var m,n,o,p,q,r=j.width;for(l=0,m=0;i>l;l++){n=k[l],o=0;do{for(q=n.length,p=g.measureText(n).width;p>r&&q>1;){var s=r/p*q|0;s===q?q-=1:q=0===s?1:s,n=n.substr(0,q),p=g.measureText(n).width}m++,h.push(n),o+=q,n=k[l].substr(o),q=0}while(n&&""!==n)}j.innerTextRow!==m&&(j.innerTextRow=m)}else{if(!j.innerTextWidth){var t,u=0;for(l=0,i=j.innerTextArray.length;i>l;l++)t=g.measureText(j.innerTextArray[l]).width,t>u&&(u=t);j.innerTextWidth=u}h=j.innerTextArray}}var v,w,x=a.left,y=a.top,z=1,A=0;if(j.rotate||j.scaleX||j.scaleY){var B=a.rotate,r=a.width,C=a.height;g.save(),v=-r*a.anchorX,w=-C*a.anchorY,z=Math.cos(B*b)*a.scaleX,A=Math.sin(B*b)*a.scaleY,g.transform(z,A,-A,z,x-v-r*(1-a.scaleX)/2,y-w-C*(1-a.scaleY)/2)}else v=x,w=y;j.background&&c(v,w,a,g),j.image&&d(v,w,a,g),j.innerTextArray&&e(h,v,w,a,g),(j.rotate||j.scaleX||j.scaleY)&&g.restore()}},h=function(a,d){var e=a.storage;d.globalAlpha=a.opacity;var f,g,h=1,i=0;if(e.rotate||e.scaleX||e.scaleY){var j=a.rotate;d.save(),f=-a.width/2,g=-a.height/2,h=Math.cos(j*b)*a.scaleX,i=Math.sin(j*b)*a.scaleY,d.transform(h,i,-i,h,a.left-f,a.top-g)}else f=a.left,g=a.top;e.background&&c(f,g,a,d),(e.rotate||e.scaleX||e.scaleY)&&d.restore()};return a.parse=function(b,c){var d=0,e=b.style,f=b.cache;if(f){var i=a.drawer.ctx(f);if(b.waitDrawing){i.clearRect(0,0,e.width,e.height);for(var j=b.children,k=j.length,l=0;k>l;l++)d+=a.parse(j[l],i);b.waitDrawing=!1}b.parent&&(h(e,c),a.drawer.drawImage(f,0,0,f.width,f.height,e.left,e.top,f.width,f.height,c))}else g(e,c);return++d},a}(),r=function(){var a,b={},c=[],d=[],f=[],g=function(a,b){this.type=b||"unknown",this.x=(a.x-e.system.margin.left)/e.system.scale.x,this.y=(a.y-e.system.margin.top)/e.system.scale.y},h=function(a,b,c){var d,e=[],f=a.x,g=a.y;for(d=0;d<b.length;d++){var h=b[d];h.active&&h.style.coordinateX<f&&h.style.coordinateY<g&&f<h.style.coordinateX+h.style.width&&g<h.style.coordinateY+h.style.height&&e.push(h)}c(e)},i=function(a){var b=new g(e.getter.mouseEvent(a),"touchDown");h(b,c,function(a){for(var c=0;c<a.length&&a[c].touchDown(null,b);c++);})},j=function(a){var b=new g(e.getter.mouseEvent(a),"touchMove");return h(b,d,function(a){for(var c=0;c<a.length&&a[c].touchMove(null,b);c++);}),a&&a.preventDefault?a.preventDefault():window.event.returnValue=!1,!1},k=function(a){var b=new g(e.getter.mouseEvent(a),"touchUp");h(b,f,function(a){for(var c=0;c<a.length&&a[c].touchUp(null,b);c++);})};return b.init=function(){a=document.getElementById(e.id),e.system.isMobile?(a.addEventListener(e.getter.touchDown,i),a.addEventListener(e.getter.touchMove,j),a.addEventListener(e.getter.touchUp,k)):(a.addEventListener(e.getter.mouseDown,i),a.addEventListener(e.getter.mouseMove,j),a.addEventListener(e.getter.mouseUp,k))},b.addTouchDown=function(a){for(var b=0;b<c.length;b++)if(a.uniqueNumber>c[b].uniqueNumber)return void c.splice(b,0,a);c.push(a)},b.addTouchMove=function(a){for(var b=0;b<d.length;b++)if(a.uniqueNumber>d[b].uniqueNumber)return void d.splice(b,0,a);d.push(a)},b.addTouchUp=function(a){for(var b=0;b<f.length;b++)if(a.uniqueNumber>f[b].uniqueNumber)return void f.splice(b,0,a);f.push(a)},b.removeTouchDown=function(a){for(var b=0;b<c.length;b++)if(a.uniqueNumber==c[b].uniqueNumber)return void c.splice(b,1)},b.removeTouchMove=function(a){for(var b=0;b<d.length;b++)if(a.uniqueNumber==d[b].uniqueNumber)return void d.splice(b,1)},b.removeTouchUp=function(a){for(var b=0;b<f.length;b++)if(a.uniqueNumber==f[b].uniqueNumber)return void f.splice(b,1)},b}(),s=function(){var a={node:l,block:o,texture:k,audio:m,font:n},b={};b.createNode=function(b){var c=a[b];return c?new c:null},b.getNodeWithId=function(a){return c(h.canvas,a)};var c=function(a,b){if(a.id===b)return a;var d,e,f,g=a.children;if(!g||0===g.length)return null;for(d=0,e=g.length;e>d;d++)if(f=c(g[d],b))return f;return null};return b.defineNode=function(b,c){a[b]=c},b}();!function(){var a=function(){};return a.prototype.visibleWidth=function(){return document.documentElement.clientWidth},a.prototype.visibleHeight=function(){return document.documentElement.clientHeight},a.prototype.marginLeft=function(a){return a.offsetParent?arguments.callee(a.offsetParent)+a.offsetLeft:a.offsetLeft},a.prototype.marginTop=function(a){return a.offsetParent?arguments.callee(a.offsetParent)+a.offsetTop:a.offsetTop},a.prototype.mouseDown="mousedown",a.prototype.mouseMove="mousemove",a.prototype.mouseIn="mouseover",a.prototype.mouseOut="mouseout",a.prototype.mouseUp="mouseup",a.prototype.touchDown="touchstart",a.prototype.touchMove="touchmove",a.prototype.touchUp="touchend",a.prototype.mouseEvent=function(a){var b={point:[]};if(a.changedTouches){b.x=a.changedTouches[0].clientX,b.y=a.changedTouches[0].clientY;for(var c=0;c<a.changedTouches.length;c++){var d=a.changedTouches[c];b.point.push({x:d.clientX,y:d.clientY})}}else b.x=a.x,b.y=a.y,b.point.push({x:a.x,y:a.y});return b},e.getter||(e.getter=new a),a}()}!function(){var a=function(){};a.prototype.init=function(){},a.prototype.ctx=function(a){return a.getContext("2d")},a.prototype.drawRect=function(a,b,c,d,e,f){f.fillStyle!==a&&(f.fillStyle=a),f.fillRect(b,c,d,e)},a.prototype.drawLine=function(){},a.prototype.drawImage=function(a,b,c,d,e,f,g,h,i,j){j.drawImage(a,b,c,d,e,f,g,h,i)},a.prototype.setFont=function(a,b,c,d,e){var f=a+" "+b+"px "+c;d=d||"left",e.font!==f&&(e.font=f),e.textAlign!==d&&(e.textAlign=d)},a.prototype.drawFont=function(a,b,c,d,e,f){f.fillStyle!==c&&(f.fillStyle=c),a&&f.fillText(a,d,e+b)},q.drawer||(q.drawer=new a)}(),window.h=function(){var a,b=[],c=[],f=function(a){if(!a)return f.canvas;var b=a.substr(0,1);return g[b]?(arguments[0]=a.substr(1),g[b].apply(this,arguments)):"canvas"===a?f.canvas:null},g={"#":function(){return s.getNodeWithId.apply(this,arguments)},"@":function(){return s.createNode.apply(this,arguments)}};return f.utils=d,f.options=e,f.log=function(){},f.delay=function(a,c){for(var d={time:i.line+c,callback:a},e=0,f=d.time;b[e]&&b[e].time<f;)e++;b.splice(e,0,d)},f.interval=function(a,b){var c=function(){a(),f.interval(a,b)};c.ctor=a,f.delay(c,b)},f.clearDelay=function(a){for(var c=0;c<b.length;c++)if((b[c].callback.ctor||b[c].callback)===a){b.splice(c,1);break}},f.setOption=function(a){a.id&&(e.id=a.id),a.debug&&(e.debug=a.debug)},f.adaptive=function(b){null!=b&&(e.adaptive=b);var c={padding:0,margin:0,overflow:"hidden",height:e.system.visibleSize.height+"px",width:e.system.visibleSize.width+"px"};for(var d in c)document.body.style[d]=c[d];1===e.adaptive?p.full(a):2===e.adaptive?p.width(a):3===e.adaptive?p.height(a):4===e.adaptive?p.min(a):5===e.adaptive&&p.max(a)},f.init=function(d){a=document.getElementById(e.id),f.canvas=new o,f.canvas.style.width=a.width,f.canvas.style.height=a.height,f.canvas.cache=a,f.canvas.active=!0,e.setCanvas(a),e.initOption(),i.start(function(){for(;b[0]&&b[0].time<i.line;)b.shift().callback();var c=q.parse(f.canvas,q.drawer.ctx(a));f._getDebugInfo(b.length,c)}),r.init(),c.forEach(function(a){a(d)}),"function"==typeof d&&d()},f.addInitTask=function(a){"function"==typeof a&&c.push(a)},f._getDebugInfo=function(){},f}(),function(){var a=function(){this.option=e,this.utils=d,this.drawManager=q,this.elemManager=s,this.eventManager=r,this.viewManager=p,this.node=l,this.block=o,this.audio=m,this.texture=k};h.engine=new a}(),function(a,b,c,d){var e,f,g,i,j,k,l,m,n,o=function(){if(!h.options.debug)return!1;e=(new a).set({width:200,height:195,background:"#222",opacity:.3,zIndex:Number.MAX_VALUE}),f=(new c).set({color:"#fff",left:10,top:5}).text("harbors 0.0.1"),g=(new c).set({color:"#fff",left:10,top:25}).text(h.options.system.os+"  "+h.options.system.browser+"  "+h.options.system.version.substr(0,8)+"..."),i=(new c).set({color:"#fff",left:10,top:45}).text("time:      draw:         task:"),j=[];for(var b=0;6>b;b++)j.push((new c).set({color:"#fff",left:10,top:65+20*b})),e.append(j[b]);l=(new c).set({color:"#fff",left:42,top:45}).text("0"),n=(new c).set({color:"#fff",left:100,top:45}).text("0"),k=(new c).set({color:"#fff",left:162,top:45}).text("0"),e.append(f),e.append(g),e.append(i),e.append(l),e.append(n),e.append(k),h("canvas").append(e),m=[],h.log=function(a){for(var b=1;b<arguments.length;b++)switch(typeof arguments[b]){case"string":a=a.replace("%s",arguments[b]);break;case"number":a=a.replace("%d",arguments[b]);break;default:a=a.replace("%s",arguments[b].toString())}for(m.push(a);m.length>6;)m.shift();for(b=0;b<m.length;b++)j[b].text(m[b])};var o=0;d.getDrawTime=function(a){o++<30||(o=0,l&&l.text(a))};var p=0;h._getDebugInfo=function(a,b){p++<30||(p=0,k&&k.text(a),n&&n.text(b))}};h.addInitTask(o)}(o,l,n,i)}(window);