<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>Module</title>
    <link href="css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<style>
    body {
        padding: 40px;
    }
</style>

<table class="table table-hover">
    <tbody id="table"></tbody>
</table>
<br/>
<a onclick="return Load(this);" type="button" class="btn btn-primary" target="_blank">Download</a>
<script src="module.js"></script>
<script>

    var pageSet = {
        html: '',
        list: {},
        _rule: {},
        _template: '',
        _check: 0,
        _table: document.getElementById("table")
    };

    pageSet.init = function () {
        pageSet.createHTML();
    };

    pageSet.Html = function (result) {

        var _tr = document.createElement('tr');

        var _td = document.createElement('td');
        _td.style.width = '30px';
        var _input = document.createElement('input');
        _input.id = result.name;
        _input.onclick = function(){
            pageSet._check = 0;
            return pageSet.checkDown.call(this, result);
        };
        _input.type = 'checkbox';
        if (result.name == 'core') {
            _input.checked = true;
            result.checked = 1;
        }
        _td.appendChild(_input);
        _tr.appendChild(_td);

        _td = document.createElement('td');
        _td.style.width = '200px';
        _td.innerHTML = result.name;
        _tr.appendChild(_td);

        _td = document.createElement('td');
        _td.innerHTML = result.size || 'Unknow';
        _td.style.width = '40px';
        _td.style['text-align'] = 'right';
        _tr.appendChild(_td);

        _td = document.createElement('td');
        _td.style['padding-left'] = '40px';
        _td.innerHTML = result.info || 'Unknow';
        _tr.appendChild(_td);

        pageSet._table.appendChild(_tr);
    };

    pageSet.createHTML = function(){
        module.info.forEach(function (_result) {
            pageSet.Html(_result);
        });
    };

    pageSet.checkDown = function (result) {
        if(name == 'core' || pageSet._check++ > 4){
            return false;
        }

        if(!!this.checked)
            result.rule.forEach(function (_y) {
                var _t = document.getElementById(_y);
                var _l;
                for (var i = 0; i < module.info.length; i++) {
                    if (module.info[i].name == _y) _l = module.info[i];
                }
                _l.checked = 1;
                _t.checked = 1;
                pageSet.checkDown.call(_t, _l);
            });

        result.checked = !!this.checked ? 1 : 0;
    };

    pageSet.init();

    var Load = function(_a){
        var _s = 'download_.js?file=';

        module.info.forEach(function (_module) {
            if (_module.checked) {
                _s += _module.name + ',';
            }
        });

        _s = _s.substr(0, _s.length-1);
        _a.href = _s;
    };
</script>

</body>
</html>