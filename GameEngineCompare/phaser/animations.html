<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <title>Phaser Examples</title>
    <script src="build/phaser.min.js" type="text/javascript"></script>
</head>
<body>

<div id="phaser-example"></div>
<div id="fps"></div>

<script>
    var game = new Phaser.Game(800, 500, Phaser.CANVAS, 'phaser-example', { preload: preload, create: create, update: update });

    function preload() {

        game.load.spritesheet('fish', '../resources/anim1.png', 50, 26, 3);

    }

    function create() {
        console.log(game.time.fps);

        //  This creates a simple sprite that is using our loaded image and
        //  displays it on-screen
        console.time("add 5000 sprites");
        for(var i=0;i<5000;i++){
//            this.addFish(fish[(imgIndex++)%fish.length]);
            var _t = game.add.sprite((i*50)%800, (((i/16) | 0) * 26) % 494, 'fish');
            var anim = _t.animations.add('walk');

            anim.onLoop.add(animationLooped, this);

            anim.play(2, true);


        }
        console.timeEnd("add 5000 sprites");

    }

    var _fps = document.getElementById('fps');
    var timeout = 0;
    var fps = 0;

    function animationLooped(sprite, animation) {



    }

    function update(){
        if (game.time.time > timeout) {
            _fps.innerHTML = fps;

            fps = 0;
            timeout = game.time.time + 1000;
        }else{
            fps++;
        }
    }
</script>
</body>
</html>